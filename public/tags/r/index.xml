<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>R | Ruoyu Wang</title>
    <link>/tags/r/</link>
      <atom:link href="/tags/r/index.xml" rel="self" type="application/rss+xml" />
    <description>R</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><copyright>2020</copyright><lastBuildDate>Mon, 09 Mar 2020 15:05:12 -0800</lastBuildDate>
    <image>
      <url>/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png</url>
      <title>R</title>
      <link>/tags/r/</link>
    </image>
    
    <item>
      <title>Analysis Santa Barbara water chemistry with four ways</title>
      <link>/project/sb-chemistry/</link>
      <pubDate>Mon, 09 Mar 2020 15:05:12 -0800</pubDate>
      <guid>/project/sb-chemistry/</guid>
      <description>


&lt;div id=&#34;introduction&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;1. Introduction&lt;/h3&gt;
&lt;p&gt;In this report, we will explore the stream chemistry in Santa Barbara water shed with four different approaches. The data set includes dissolved nitrogen (nitrate, ammonium, total dissolved nitrogen); soluble reactive phosphorus (SRP); particulate organic carbon, nitrogen and phosphorus; total suspended sediments; and conductivity. Stream water samples are collected weekly during non-storm flows in winter, and bi-weekly during summer. During winter storms, samples are collected hourly (rising limb) or at 2-4 hour intervals (falling limb).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;multiple-methods-to-analysis-data&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;2. Multiple methods to analysis data&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Attach necessary packages
library(tidyverse)
library(janitor)
library(naniar) # for gg_miss_var, find the NA distribution
library(stargazer) # regression table
library(corrplot) # correlations plot
library(gt) # make nice table
library(plotly) # 3d plot_ly
library(ggfortify) # autoplot for biplot
library(factoextra) # PC contribution

# Packages for cluster analysis:
library(NbClust)
library(cluster)
library(factoextra)
library(dendextend)
library(ggdendro)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Read in raw data, we can see the &amp;quot;-999&amp;quot; and &amp;quot;-999.0&amp;quot; should be the missing data
chemistry &amp;lt;- read_csv(&amp;quot;sbc_lter_registered_stream_chemistry.csv&amp;quot;,
                      na = c(&amp;quot;-999&amp;quot;, &amp;quot;-999.0&amp;quot;))

# Only keep the numeric columns
chem_num &amp;lt;- chemistry %&amp;gt;% 
  select(-site_code, -timestamp_local)

chem_full_nona &amp;lt;- chemistry %&amp;gt;% 
  #select(-timestamp_local) %&amp;gt;% 
  select(-tpp_uM, -tpn_uM, -tpc_uM, -tss_mgperLiter) %&amp;gt;% 
  drop_na()
  
# Check the NA amount in each column
gg_miss_var(chem_num)+
  labs(x = &amp;quot;&amp;quot;, y = &amp;quot;Number of missing variables&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/sb-chemistry/index_files/figure-html/data_pre-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# The tpp, tpn, tpc, and tss contains too many missing values, we will exclude them for the future analysis

# drop all the NAs version
chem_nona &amp;lt;-  chem_num %&amp;gt;% 
  select(-tpp_uM, -tpn_uM, -tpc_uM, -tss_mgperLiter) %&amp;gt;% 
  drop_na()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Figure. 1&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;The lollipop plot for the original data set clearly presents column tpp_uM, tpn_uM, tpc_uM, and tss_uM contains about 15,000 missing values. Data source: Santa Barbara Coastal LTER and J. Melack. 2019..&lt;/em&gt;&lt;/p&gt;
&lt;div id=&#34;multiple-linear-regression&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;1. Multiple linear regression&lt;/h4&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Keep all the variables
chem_lm1 &amp;lt;- lm(spec_cond_uSpercm ~ site_code + no3_uM + nh4_uM + po4_uM + tdn_uM + tdp_uM, data = chem_full_nona)

# delete NO3, NH4 and PO4
chem_lm2 &amp;lt;- lm(spec_cond_uSpercm ~ site_code + tdn_uM + tdp_uM, data = chem_full_nona)

# Delete total dissolved N and P
chem_lm3 &amp;lt;- lm(spec_cond_uSpercm ~ site_code + no3_uM + nh4_uM + po4_uM , data = chem_full_nona)

# Delete the sampling locations
chem_lm4 &amp;lt;- lm(spec_cond_uSpercm ~  no3_uM + nh4_uM + po4_uM + tdn_uM + tdp_uM, data = chem_full_nona)

# summary(chem_lm1)
# summary(chem_lm2)
# summary(chem_lm3)
# summary(chem_lm4)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;AIC evaluates the multiple linear models. Normally, we would like to keep the model with lowest AIC.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;AIC(chem_lm1)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 205956.9&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;AIC(chem_lm2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 206082.6&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;AIC(chem_lm3)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 206451.9&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;AIC(chem_lm4)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 208786&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The model 1 (with full variables) have the lowest AIC. Combining with reality, we know that though NO3 and NH4 are important part of total dissolved nitrogen, PO4 is the most common type of total dissolved P, there are many other kinds of N,P compounds in TDN and TDP. Therefore, none of the variables are redundant. We believe the model 1 is the most sound model conceptionally.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Table. 1&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;The regression table shows three different models to predict specific conductivity based on different factors. Model (1) considered the sample sites, nitrate, ammonium, phosphate, total dissolved nitrogen and total dissolved phosphorus’s influence on specific conductivity. Model (2) only studied the effect from sites TDN, and TNP, while model (3) only considered the impact from sites and three inorganic N, P chemicals. Data: Santa Barbara Coastal LTER and J. Melack, 2019.&lt;/em&gt;&lt;/p&gt;
&lt;div align=&#34;center&#34;&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Made a nice regression table with three models created above.
stargazer(chem_lm1, chem_lm2, chem_lm3, type = &amp;quot;html&amp;quot;, 
          align = TRUE, dep.var.labels=&amp;quot;Specific conductivity  (uS/cm)&amp;quot;,
          covariate.labels=c(&amp;quot;Atascadero&amp;quot;,
                             &amp;quot;Bell Canyon&amp;quot;,
                             &amp;quot;Devereaux&amp;quot;,
                             &amp;quot;Gaviota&amp;quot;,
                             &amp;quot;Arroyo Hondo&amp;quot;,
                             &amp;quot;Mission at Montecito&amp;quot;,
                             &amp;quot;Mission at Rocky&amp;quot;,
                             &amp;quot;San Onofre&amp;quot;,
                             &amp;quot;Refugio&amp;quot;,
                             &amp;quot;Rattlesnake&amp;quot;,
                             &amp;quot;San Pedro&amp;quot;,
                             &amp;quot;Tecolote&amp;quot;,
                             &amp;quot;NO3 (uM)&amp;quot;,
                             &amp;quot;NH4 (uM)&amp;quot;,
                             &amp;quot;PO4 (uM)&amp;quot;,
                             &amp;quot;Total dissolved nitrogen (uM)&amp;quot;,
                             &amp;quot;Total dissolved phosphorus (uM)&amp;quot;),
          omit.stat=c(&amp;quot;LL&amp;quot;,&amp;quot;ser&amp;quot;,&amp;quot;f&amp;quot;), 
          no.space=FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;table style=&#34;text-align:center&#34;&gt;
&lt;tr&gt;
&lt;td colspan=&#34;4&#34; style=&#34;border-bottom: 1px solid black&#34;&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td colspan=&#34;3&#34;&gt;
&lt;em&gt;Dependent variable:&lt;/em&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td colspan=&#34;3&#34; style=&#34;border-bottom: 1px solid black&#34;&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td colspan=&#34;3&#34;&gt;
Specific conductivity (uS/cm)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(1)
&lt;/td&gt;
&lt;td&gt;
(2)
&lt;/td&gt;
&lt;td&gt;
(3)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td colspan=&#34;4&#34; style=&#34;border-bottom: 1px solid black&#34;&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Atascadero
&lt;/td&gt;
&lt;td&gt;
303.042&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
267.393&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
263.250&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(39.711)
&lt;/td&gt;
&lt;td&gt;
(39.788)
&lt;/td&gt;
&lt;td&gt;
(40.455)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Bell Canyon
&lt;/td&gt;
&lt;td&gt;
-264.189&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-262.270&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-174.672&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(44.285)
&lt;/td&gt;
&lt;td&gt;
(44.017)
&lt;/td&gt;
&lt;td&gt;
(44.532)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Devereaux
&lt;/td&gt;
&lt;td&gt;
1,727.261&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
1,737.033&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
1,657.922&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(45.836)
&lt;/td&gt;
&lt;td&gt;
(45.754)
&lt;/td&gt;
&lt;td&gt;
(46.564)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Gaviota
&lt;/td&gt;
&lt;td&gt;
138.141&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
154.394&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
157.390&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(29.793)
&lt;/td&gt;
&lt;td&gt;
(29.903)
&lt;/td&gt;
&lt;td&gt;
(30.351)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Arroyo Hondo
&lt;/td&gt;
&lt;td&gt;
-256.820&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-204.351&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-233.454&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(46.737)
&lt;/td&gt;
&lt;td&gt;
(46.710)
&lt;/td&gt;
&lt;td&gt;
(47.628)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Mission at Montecito
&lt;/td&gt;
&lt;td&gt;
-371.673&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-353.232&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-378.226&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(29.396)
&lt;/td&gt;
&lt;td&gt;
(29.502)
&lt;/td&gt;
&lt;td&gt;
(29.976)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Mission at Rocky
&lt;/td&gt;
&lt;td&gt;
-338.164&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-303.267&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-354.002&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(41.103)
&lt;/td&gt;
&lt;td&gt;
(41.134)
&lt;/td&gt;
&lt;td&gt;
(41.898)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
San Onofre
&lt;/td&gt;
&lt;td&gt;
-463.251&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-432.204&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-380.020&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(37.268)
&lt;/td&gt;
&lt;td&gt;
(37.305)
&lt;/td&gt;
&lt;td&gt;
(37.748)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Refugio
&lt;/td&gt;
&lt;td&gt;
145.870&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
169.330&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
199.586&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(29.790)
&lt;/td&gt;
&lt;td&gt;
(29.822)
&lt;/td&gt;
&lt;td&gt;
(30.283)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Rattlesnake
&lt;/td&gt;
&lt;td&gt;
-510.580&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-475.214&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-459.324&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(30.434)
&lt;/td&gt;
&lt;td&gt;
(30.419)
&lt;/td&gt;
&lt;td&gt;
(30.896)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
San Pedro
&lt;/td&gt;
&lt;td&gt;
-357.364&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-338.600&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-366.516&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(43.572)
&lt;/td&gt;
&lt;td&gt;
(43.724)
&lt;/td&gt;
&lt;td&gt;
(44.433)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Tecolote
&lt;/td&gt;
&lt;td&gt;
-224.429&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-207.543&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-169.234&lt;sup&gt;**&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(73.998)
&lt;/td&gt;
&lt;td&gt;
(73.990)
&lt;/td&gt;
&lt;td&gt;
(75.376)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
NO3 (uM)
&lt;/td&gt;
&lt;td&gt;
-0.164
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
0.831&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(0.102)
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
(0.049)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
NH4 (uM)
&lt;/td&gt;
&lt;td&gt;
1.846&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
2.200&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(0.527)
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
(0.501)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
PO4 (uM)
&lt;/td&gt;
&lt;td&gt;
-18.179&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
-37.974&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(1.710)
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
(1.381)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Total dissolved nitrogen (uM)
&lt;/td&gt;
&lt;td&gt;
1.047&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
0.932&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(0.095)
&lt;/td&gt;
&lt;td&gt;
(0.044)
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Total dissolved phosphorus (uM)
&lt;/td&gt;
&lt;td&gt;
-39.089&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
-49.795&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(1.891)
&lt;/td&gt;
&lt;td&gt;
(1.478)
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Constant
&lt;/td&gt;
&lt;td&gt;
1,192.675&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
1,155.553&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
1,122.792&lt;sup&gt;***&lt;/sup&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
(23.944)
&lt;/td&gt;
&lt;td&gt;
(23.815)
&lt;/td&gt;
&lt;td&gt;
(23.813)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td colspan=&#34;4&#34; style=&#34;border-bottom: 1px solid black&#34;&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Observations
&lt;/td&gt;
&lt;td&gt;
12,649
&lt;/td&gt;
&lt;td&gt;
12,649
&lt;/td&gt;
&lt;td&gt;
12,649
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
R&lt;sup&gt;2&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
0.256
&lt;/td&gt;
&lt;td&gt;
0.248
&lt;/td&gt;
&lt;td&gt;
0.226
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
Adjusted R&lt;sup&gt;2&lt;/sup&gt;
&lt;/td&gt;
&lt;td&gt;
0.255
&lt;/td&gt;
&lt;td&gt;
0.247
&lt;/td&gt;
&lt;td&gt;
0.225
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td colspan=&#34;4&#34; style=&#34;border-bottom: 1px solid black&#34;&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;
&lt;em&gt;Note:&lt;/em&gt;
&lt;/td&gt;
&lt;td colspan=&#34;3&#34; style=&#34;text-align:right&#34;&gt;
&lt;sup&gt;&lt;em&gt;&lt;/sup&gt;p&amp;lt;0.1; &lt;sup&gt;&lt;strong&gt;&lt;/sup&gt;p&amp;lt;0.05; &lt;sup&gt;&lt;/strong&gt;&lt;/em&gt;&lt;/sup&gt;p&amp;lt;0.01
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;correlation-matrices&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;2. Correlation matrices&lt;/h4&gt;
&lt;p&gt;look at correlations between numeric variables&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;colnames(chem_nona) &amp;lt;- c(&amp;quot;NH4&amp;quot;, &amp;quot;NO3&amp;quot;, &amp;quot;PO4&amp;quot;, &amp;quot;Total dissolved nitrogen&amp;quot;, &amp;quot;Total dissolved phosphorus&amp;quot;, &amp;quot;Specific conductivity&amp;quot;)

chem_cor &amp;lt;- cor(chem_nona)
# chem_cor

corrplot(chem_cor, 
         method = &amp;quot;color&amp;quot;, # could also do &amp;quot;circle&amp;quot;
         type = &amp;quot;lower&amp;quot;,
         tl.col = &amp;quot;black&amp;quot;,
         tl.srt = 0.001,
         tl.cex = 0.8,
         tl.offset = 1,
         addCoef.col = &amp;quot;black&amp;quot;,
         outline = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/sb-chemistry/index_files/figure-html/cor-1.png&#34; width=&#34;864&#34; style=&#34;display: block; margin: auto;&#34; /&gt;
&lt;strong&gt;&lt;em&gt;Figure. 2&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;The Scree plot for food nutrients PCA clearly presents the contributions of each principal component. Data source: Santa Barbara Coastal LTER and J. Melack. 2019.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Summary:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;NO3 and total dissolved nitrogen are positive correlated strongly, PO4 concentration and total dissolved phosphorus have positive correlation as well;&lt;/li&gt;
&lt;li&gt;Nitrogen related measurements have positive correlation with conductivity; phosphorus related indexes are slightly negative correlated with conductivity.&lt;/li&gt;
&lt;li&gt;Pairs like NH4 and NO3, NO3 and PO4, TDN and TDP, NO3 and TDP have tiny correlations within each pair.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;principal-components-analysis&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;3. Principal components analysis&lt;/h4&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;chem_pca &amp;lt;- prcomp(chem_nona, scale = TRUE)

# summary(chem_pca)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Vasuraling the PC contributions
fviz_eig(chem_pca, addlabels = TRUE, ylim = c(0, 38))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/sb-chemistry/index_files/figure-html/pca_scree-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;
&lt;strong&gt;&lt;em&gt;Figure. 3&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;The Scree plot for water quality measurement PCA clearly presents the contributions of each principal component. Data source: Santa Barbara Coastal LTER and J. Melack. 2019.&lt;/em&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;autoplot(chem_pca,
         data = chem_full_nona,
         colour = &amp;quot;site_code&amp;quot;,
         size = 0.3,
         loadings.label = TRUE,
         loadings.label.size = 3,
         loadings.label.colour = &amp;quot;black&amp;quot;,
         loadings.label.repel = TRUE) +
  scale_y_continuous(limits = c(-0.05, 0.075))+
  labs(colour = &amp;quot;Site Code&amp;quot;)+
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/sb-chemistry/index_files/figure-html/pca_plot-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;
&lt;strong&gt;&lt;em&gt;Figure. 4&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;The biplot shows the loadings of each variable (red arrows with black labels) and the position for each observation (colorful points) in the first two principal components. Data source: Santa Barbara Coastal LTER and J. Melack. 2019.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Summary:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In this estimation, some correlations are noticeable:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PO4 concentration and total dissolved phosphorus are positive correlated strongly, NO3 and total dissolved nitrogen have positive correlation as well;&lt;/li&gt;
&lt;li&gt;NO3 and dissolved nitrogen are positively correlated with conductivity;&lt;/li&gt;
&lt;li&gt;It seems no correlation between NH4 and conductivity;&lt;/li&gt;
&lt;li&gt;PO4 and total dissolved phosphorus are slightly negative correlated with conductivity.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;hierarchical-clustering&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;4. Hierarchical clustering&lt;/h4&gt;
&lt;p&gt;Relevant functions:&lt;/p&gt;
&lt;p&gt;stats::hclust() - agglomerative hierarchical clustering
cluster::diana() - divisive hierarchical clustering&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;chem_hier &amp;lt;- chem_full_nona %&amp;gt;% 
  group_by(site_code) %&amp;gt;% 
  summarize(
    nh4 = mean(nh4_uM),
    no3 = mean(no3_uM),
    po4 = mean(po4_uM),
    tdn = mean(tdn_uM),
    tdp = mean(tdp_uM),
    spec_cond = mean(spec_cond_uSpercm)
  )

# Scale it 
chem_scaled &amp;lt;- as.data.frame(scale(chem_hier[2:7]))

# Update to add rownames (site name)
rownames(chem_scaled) &amp;lt;- chem_hier$site_code

# Compute dissimilarity values (Euclidean distances):
diss &amp;lt;- dist(chem_scaled, method = &amp;quot;euclidean&amp;quot;)

# Hierarchical clustering (complete linkage)
hc_complete &amp;lt;- hclust(diss, method = &amp;quot;complete&amp;quot;)

# Convert to class &amp;#39;dendro&amp;#39; for ggplotting
data1 &amp;lt;- dendro_data(hc_complete)

# Simple plot with ggdendrogram
ggdendrogram(hc_complete, 
             rotate = TRUE) +
  theme_minimal() +
  labs(x = &amp;quot;Site code&amp;quot;, y = &amp;quot;&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/sb-chemistry/index_files/figure-html/hr_data-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;
&lt;strong&gt;&lt;em&gt;Figure. 5&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;The cluster dendrogram for different sampling sites with complete method. We can see the similarity of water quality measurements among each group. Data source: Santa Barbara Coastal LTER and J. Melack. 2019.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Divisive clustering:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;hc_div &amp;lt;- diana(diss)

plot(hc_div, hang = -1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/sb-chemistry/index_files/figure-html/div_hc-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;rect.hclust(hc_div, k = 6, border = 2:5)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/sb-chemistry/index_files/figure-html/div_hc-2.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;
&lt;strong&gt;&lt;em&gt;Figure. 6&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;The cluster dendrogram for different sampling sites with divisive clustering. We can see the similarity of water quality measurements among each group. Data source: Santa Barbara Coastal LTER and J. Melack. 2019.&lt;/em&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Convert to class dendrogram
dend1 &amp;lt;- as.dendrogram(hc_complete)
dend2 &amp;lt;- as.dendrogram(hc_div)

# Combine into list
dend_list &amp;lt;- dendlist(dend1,dend2)

# Make a tanglegram
tanglegram(dend1, dend2)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/sb-chemistry/index_files/figure-html/compare_hc-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Figure. 7&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;The tanglegram shows the difference between complete method and divisive clustering in grouping the sites. Data source: Santa Barbara Coastal LTER and J. Melack. 2019.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Data source: Santa Barbara Coastal LTER and J. Melack. 2019. SBC LTER: Land: Stream chemistry in the Santa Barbara Coastal drainage area, ongoing since 2000 ver 16. Environmental Data Initiative. &lt;a href=&#34;https://doi.org/10.6073/pasta/67a558a24ceed9a0a5bf5e46ab841174&#34; class=&#34;uri&#34;&gt;https://doi.org/10.6073/pasta/67a558a24ceed9a0a5bf5e46ab841174&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Text Mining with Silent Spring</title>
      <link>/project/text-mining/</link>
      <pubDate>Sun, 08 Mar 2020 15:05:12 -0800</pubDate>
      <guid>/project/text-mining/</guid>
      <description>


&lt;div id=&#34;background&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;1. Background&lt;/h3&gt;
&lt;p&gt;Silent Spring is a book published in August, 1962 by Rachel Carson. This true story telling book focused the chemical damages on animals and ecosystem. Silent Spring encouraged huge discussion and reflection in the whole society. In this report, we will split the whole book into single words and analyze the sentimental tendency behind the words.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;tidy-version-of-texts&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;2. Tidy version of texts&lt;/h3&gt;
&lt;p&gt;First, read in the book PDF file.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Store the original pdf file
silent_spring &amp;lt;- &amp;quot;silent_spring.pdf&amp;quot;

# Read in the pdf
sil_spr_text &amp;lt;- pdftools::pdf_text(silent_spring)
# Each page goes into one row&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Through &lt;code&gt;sil_spr_text&lt;/code&gt;, we can see that the line breakers are &lt;code&gt;\n&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Next, we will split the pages into lines in the cells.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sil_spr_df &amp;lt;- data.frame(sil_spr_text) %&amp;gt;% 
  dplyr::mutate(text_full = stringr::str_split(sil_spr_text, 
                                               pattern = &amp;quot;\\n&amp;quot;)) %&amp;gt;% 
  # Now each line is in the group of each page
  unnest(text_full) %&amp;gt;% 
  mutate(text_full = stringr::str_trim(text_full)) 
  # remove extra white spaces at the beginning&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now, put each word into its own cell.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sil_spr_tokens &amp;lt;- sil_spr_df %&amp;gt;% 
  dplyr::select(-sil_spr_text) %&amp;gt;% # only keep the line column
  unnest_tokens(word, text_full) # the new column is &amp;quot;word&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Notice that there are lots of meaningless words and numbers, we can remove the stop words and numeric pieces:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sil_spr_stop &amp;lt;- sil_spr_tokens %&amp;gt;% 
  anti_join(stop_words) 
  # find and remove all the same words in the stop word list

sil_spr_nonum &amp;lt;- sil_spr_stop %&amp;gt;% 
  dplyr::filter(is.na(as.numeric(word)))
  # filter out all the numbers&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;word-frequency-visualization&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;2. Word frequency visualization&lt;/h3&gt;
&lt;div id=&#34;a.-the-most-common-meaningful-words-in-the-document&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;a. The most common meaningful words in the document&lt;/h4&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Count the occurences of words
sil_spr_n &amp;lt;- sil_spr_nonum %&amp;gt;% 
  count(word) 

# Make a nice wordcloud
wordcloud(words = sil_spr_n$word, freq = sil_spr_n$n,
          max.words = 200, random.order = FALSE,
          rot.per=0.35, 
          colors=brewer.pal(8, &amp;quot;Dark2&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/text-mining/index_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;With the word cloud, we can see the top-200 common words in this book. The font sizes also depend on the words’ frequency.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sil_spr_top20 &amp;lt;- sil_spr_n %&amp;gt;% 
  arrange(-n) %&amp;gt;% 
  head(20)

# Make a nice lolipop plot for the word occurence
ggplot(data = sil_spr_top20, 
       aes(x = reorder(word, n), y = n)) +
  geom_point(aes(color = word), size = 2,
             show.legend = FALSE) +
  geom_segment(aes(x = word, xend = word,
                   y = 0, yend = n,
                   color = word),
               show.legend = FALSE) +
  labs(x = &amp;quot;&amp;quot;, y = &amp;quot;Occurrence of words&amp;quot;)+
  theme_minimal()+
  coord_flip()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/text-mining/index_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We can also see the exact occurrence of the top 20 words with a nice lollipop plot!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;text-sentimental-analysis&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;3. Text sentimental analysis&lt;/h3&gt;
&lt;p&gt;There are three ways to analyze the sentimental in the texts: (i) Binary method, either positive or negative scale; (ii) Ordinal sediments, ranked values from negative to positive (-5 ~ +5); (iii) Descriptive method, words in emotional bins.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;a.-binary-method&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;a. Binary method&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ss_bing &amp;lt;- sil_spr_nonum %&amp;gt;% 
  inner_join(get_sentiments(lexicon = &amp;quot;bing&amp;quot;))

# Find counts by sentiments

ss_bing_n &amp;lt;- ss_bing %&amp;gt;% 
  count(sentiment, sort = TRUE) 

ggplot(data = ss_bing_n)+
  geom_col(aes(x = reorder(sentiment, -n), y = n,
               fill = sentiment),
           show.legend = FALSE,
           width = 0.35)+
  labs(x = &amp;quot;Sediments&amp;quot;, y = &amp;quot;Counts&amp;quot;)+
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/text-mining/index_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;It seems that the author had more negative emotions than positive ones.&lt;/p&gt;
&lt;div id=&#34;b.-ordinal-sediments&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;b. Ordinal sediments:&lt;/h4&gt;
&lt;p&gt;Polarity sentiment lexicons (ranked values on negative → positive scale) - “afinn”&lt;/p&gt;
&lt;p&gt;Polarity scores&lt;/p&gt;
&lt;p&gt;Most negative: -5; Most positive: +5.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sil_spr_afinn &amp;lt;- sil_spr_nonum %&amp;gt;% 
  inner_join(get_sentiments(lexicon = &amp;quot;afinn&amp;quot;))

# count the values of the sentiments
sil_spr_afinn_hist &amp;lt;- sil_spr_afinn %&amp;gt;% 
  count(value)

ggplot(data = sil_spr_afinn_hist, aes(x = value, y = n))+
  geom_col(aes(fill = value), show.legend = FALSE)+
  labs(x = &amp;quot;Sentimental score&amp;quot;, y = &amp;quot;Frequency&amp;quot;)+
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/text-mining/index_files/figure-html/unnamed-chunk-8-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sil_spr_summary &amp;lt;- sil_spr_afinn %&amp;gt;% 
  summarize(
    mean_score = mean(value),
    median_score = median(value)
  )&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ss_afinn_n5 &amp;lt;- sil_spr_afinn %&amp;gt;% 
  filter(! value == -5) %&amp;gt;% 
  count(word, value, sort = TRUE) %&amp;gt;% 
  group_by(value) %&amp;gt;% 
  top_n(5) %&amp;gt;%  # col = n
  ungroup()


ggplot(data = ss_afinn_n5,
                      aes(x = reorder(word, -n),
                          y = n,
                          fill = n))+
  geom_col(show.legend = FALSE)+
  facet_wrap(~value, ncol = 2, scales = &amp;quot;free&amp;quot;)+
  labs(x = &amp;quot;&amp;quot;, y = &amp;quot;Frequency&amp;quot;)+
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/text-mining/index_files/figure-html/unnamed-chunk-10-1.png&#34; width=&#34;864&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Second, let’s test with emotional words method.&lt;/p&gt;
&lt;p&gt;The NRC Emotion Lexicon is a list of English words and their associations with eight basic emotions (anger, fear, anticipation, trust, surprise, sadness, joy, and disgust) and two sentiments (negative and positive).&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sil_spr_nrc &amp;lt;- sil_spr_nonum %&amp;gt;% 
  inner_join(get_sentiments(lexicon = &amp;quot;nrc&amp;quot;))

# Find counts by sentiments

ss_nrc_n &amp;lt;- sil_spr_nrc %&amp;gt;% 
  count(sentiment, sort = TRUE) 

ggplot(data = ss_nrc_n)+
  geom_col(aes(x = reorder(sentiment, -n), y = n,
               fill = sentiment),
           show.legend = FALSE)+
  labs(x = &amp;quot;Sediments&amp;quot;, y = &amp;quot;Counts&amp;quot;)+
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/text-mining/index_files/figure-html/unnamed-chunk-11-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;How do sentiment/top words compare for speeches/documents/etc. from two or more different groups, candidates, etc.?&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ss_nrc_n5 &amp;lt;- sil_spr_nrc %&amp;gt;% 
  count(word, sentiment, sort = TRUE) %&amp;gt;% 
  group_by(sentiment) %&amp;gt;% 
  top_n(5) %&amp;gt;%  # col = n
  ungroup()


ggplot(data = ss_nrc_n5,
                      aes(x = reorder(word, -n),
                          y = n,
                          fill = sentiment))+
  geom_col(show.legend = FALSE)+
  facet_wrap(~sentiment, ncol = 2, scales = &amp;quot;free&amp;quot;)+
  labs(x = &amp;quot;&amp;quot;, y = &amp;quot;Frequency&amp;quot;)+
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/text-mining/index_files/figure-html/unnamed-chunk-12-1.png&#34; width=&#34;768&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Time series exploration with steelhead salmon</title>
      <link>/project/time-series/</link>
      <pubDate>Thu, 09 Jan 2020 00:00:00 +0000</pubDate>
      <guid>/project/time-series/</guid>
      <description>


&lt;div id=&#34;introduction&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;1. Introduction&lt;/h3&gt;
&lt;p&gt;Bonneville Dam, located on the Columbia River, is one of the biggest hydroelectric systems in the world (Desiree Ramirez, 2019). However, the presence of dam would block the reproducing and rearing habitats of many fishes, including salmon and steelhead (Northwest Power and Conservation Council, 2015). To alleviate the negative effects on fish, Hatchery utilities were built in 1909 and renovated in 1957 and 1998 (Oregon Department of Fish &amp;amp; Wildlife, 2019). In this report, we will analysis and visualize time series data for adult steelhead salmon passage across the Bonneville Dam from 1939 - 2019.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;Steelhead.jpg&#34; width=&#34;60%&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Figure. 1&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;Oncorhynchus mykiss (Steelhead) at the Oregon Zoo Picture by User: Cacophony, published on &lt;a href=&#34;https://commons.wikimedia.org/wiki/File:Steelhead.jpg&#34;&gt;Wikimedia Commons&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;data-analysis&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;2. Data analysis&lt;/h3&gt;
&lt;div id=&#34;a.-daily-data-time-series-plot-for-adult-steelhead-passage&#34; class=&#34;section level5&#34;&gt;
&lt;h5&gt;a. Daily data time series plot for adult steelhead passage&lt;/h5&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Combine the year, month and day and transform into date class in a new column

steelhead_date &amp;lt;- steelhead %&amp;gt;% 
  mutate(date = paste(year, mm_dd, sep = &amp;quot;-&amp;quot;)) %&amp;gt;% 
  mutate(date_new = lubridate::ydm(date)) %&amp;gt;%
  drop_na(date_new) 
# remove NA date, normally unexisted date: for example Feb 29, 2019 didn&amp;#39;t exist, it was transformed to NA&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Draw a daily passage line plot
ggplot(data = steelhead_date, aes(x = date_new, y = value))+
  geom_line(aes(color = year), show.legend = FALSE)+
  labs(x = &amp;quot;Date&amp;quot;, y = &amp;quot;Adult passage number (fish/day)&amp;quot;)+
  scale_color_paletteer_c(&amp;quot;grDevices::rainbow&amp;quot;)+
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/time-series/index_files/figure-html/daily_figure-1.png&#34; width=&#34;768&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Figure. 2&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;Daily adult steelhead passage through Bonneville Dam. Different colors represent different years. Data source: Data from: Columbia Basin Research Available here: &lt;a href=&#34;http://www.cbr.washington.edu/dart/query/adult_graph_text&#34;&gt;Adult fish passage&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;b.-seasonplot-showing-monthly-passage-variation&#34; class=&#34;section level5&#34;&gt;
&lt;h5&gt;b. Seasonplot showing monthly passage variation&lt;/h5&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Put month and year in seprate columns
steelhead_parsed &amp;lt;- steelhead_date %&amp;gt;% 
  mutate(month = month(date_new, label = TRUE)) %&amp;gt;% 
  mutate(date_ym = yearmonth(date_new))


# Group and calcuate data for seasonal plot
steel_season &amp;lt;- steelhead_parsed %&amp;gt;% 
  group_by(year, month) %&amp;gt;% 
  summarize(
    monthly_total = sum(value, na.rm = TRUE)
  )


# Calculate the monthly total for tsibble
steel_monthly &amp;lt;- steelhead_parsed%&amp;gt;% 
  group_by(date_ym) %&amp;gt;% 
  summarize(
    monthly_total = sum(value, na.rm = TRUE)
  ) %&amp;gt;% 
  mutate(location = &amp;quot;Bon&amp;quot;)

# convert the monthly table into tsibble format
steel_ts &amp;lt;- as_tsibble(steel_monthly, key = &amp;quot;location&amp;quot;, index = &amp;quot;date_ym&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Seasonal plot
ggplot(data = steel_season, aes(x = month, y = monthly_total, group = year))+
  geom_line(aes(color = year))+
  scale_color_paletteer_c(&amp;quot;pals::kovesi.diverging_rainbow_bgymr_45_85_c67&amp;quot;)+
  labs(x = &amp;quot;&amp;quot;, y = &amp;quot;Monthly adult steelhead passage (fish/month)&amp;quot;, color = &amp;quot;Year&amp;quot;)+
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/time-series/index_files/figure-html/seasonal_plot-1.png&#34; width=&#34;768&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Figure. 3&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;A seasonplot of adult steelhead passage across Bonneville Dam in different months for each year. The years present in different colors. From the past to the present, the color changes from blue to green, yellow and red. Data source: Data from: Columbia Basin Research Available here: &lt;a href=&#34;http://www.cbr.washington.edu/dart/query/adult_graph_text&#34;&gt;Adult fish passage&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;We can see strong and consistent pattern of the monthly passage amount within one year. The annual peaks often occur in August. Summer to early fall (July to September) is the main migration season for steelhead in this area. Besides, the size of migration seemed to grow recently. Most monthly passage amounts after 2000 (lines in red color) were relatively higher than those before 2000 (lines in colors other than red), especially in peak months.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;c.-annual-steelhead-passage-graph&#34; class=&#34;section level5&#34;&gt;
&lt;h5&gt;c. Annual steelhead passage graph&lt;/h5&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Calculate the annual total/yearly total
steel_year &amp;lt;- steelhead_date %&amp;gt;% 
  group_by(year) %&amp;gt;% 
  summarize(
    year_total = sum(value, na.rm = TRUE)
  ) &lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Make a bar graph for annual total
ggplot(data = steel_year, aes(x = year, y = year_total)) +
  geom_col(aes(fill = year), 
           width = 1, 
           color = &amp;quot;white&amp;quot;,
           show.legend = FALSE)+
  scale_fill_paletteer_c(&amp;quot;pals::kovesi.diverging_rainbow_bgymr_45_85_c67&amp;quot;)+
  labs(x = &amp;quot;Year&amp;quot;, 
       y = &amp;quot;Annual adult steelhead passage (fish/year)&amp;quot;)+
  scale_x_continuous(breaks = c(1939, 1950, 1960, 1970, 1980, 1990, 2000, 2010, 2019))+
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/time-series/index_files/figure-html/annual_plot-1.png&#34; width=&#34;768&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Figure. 4&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;Annual amount plot shows the fluctuation of the migration amounts during 1939-2019. Each column indicates the annual passage amount in the specific year. Data source: Data from: Columbia Basin Research Available here: &lt;a href=&#34;http://www.cbr.washington.edu/dart/query/adult_graph_text&#34;&gt;Adult fish passage&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;According to the Oregon Department of Fish &amp;amp; Wildlife, fish protection facilities renovations were in 1957 and 1998. Because our data only includes adult fish passage, normally there would be a time lag between spawning and increasing whole population. In this annual plot, we could see a huge rise in 2001, which was three years later than the 1998 project. However, no visible improvement happened after the 1957 program.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;d.-explore-decomposition-and-analysis-the-time-series-data&#34; class=&#34;section level5&#34;&gt;
&lt;h5&gt;d. Explore, decomposition and analysis the time series data&lt;/h5&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Decomposite the steelhead data
dcmp &amp;lt;- steel_ts %&amp;gt;% 
  model(STL(monthly_total ~ season(window = 3)))

# Plot each components of the steelhead data
components(dcmp) %&amp;gt;% autoplot() +
  labs(title = &amp;quot;STL Decomposition&amp;quot;,
       subtitle = &amp;quot;Monthly passage = trend + season_year-month + remainder&amp;quot;,
       x = &amp;quot;Date (year-month)&amp;quot;)+
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/time-series/index_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;864&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Figure. 5&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;Decomposition of the time series passage data during 1939-2019. Data source: Data from: Columbia Basin Research Available here: &lt;a href=&#34;http://www.cbr.washington.edu/dart/query/adult_graph_text&#34;&gt;Adult fish passage&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;From the original data, we could see strong seasonality, no clearly overall trend and cyclical trend. Considering the peak months are from July to August, we choose 3 as the window width. The trend in decomposition plot catches the changes in the original graph. The seasonal also contains the yearly peak feature. Additionally, the residuals seem relatively random.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Use the autocorrelation function (ACF) to further examine the seasonality
steel_ts %&amp;gt;% 
  ACF(monthly_total) %&amp;gt;% 
  autoplot()+
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/time-series/index_files/figure-html/acf-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Figure. 6&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;The autocorrelation function (ACF) of the time series passage data in 1939-2019. It shows the correlation of a time series data with itself. Data source: Columbia Basin Research Available here: &lt;a href=&#34;http://www.cbr.washington.edu/dart/query/adult_graph_text&#34;&gt;Adult fish passage&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;We can observe strong seasonality in this data. For example, months 3-9 are positively correlated with each other. Positive correlation also happens in month 10-14. While these two group are negatively correlated.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;3. References&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Columbia River DART, Columbia Basin Research, University of Washington. (2019). Adult Passage Graphics &amp;amp; Text. Available from &lt;a href=&#34;http://www.cbr.washington.edu/dart/query/adult_graph_text&#34; class=&#34;uri&#34;&gt;http://www.cbr.washington.edu/dart/query/adult_graph_text&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Desiree Ramirez. (2019, November 19). Bonneville Dam. The Official Guide to Portland. &lt;a href=&#34;https://www.travelportland.com/region/bonneville-dam/&#34; class=&#34;uri&#34;&gt;https://www.travelportland.com/region/bonneville-dam/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Oregon Department of Fish &amp;amp; Wildlife. (2019). Bonneville Hatchery Visitors’ Guide | Oregon Department of Fish &amp;amp; Wildlife. &lt;a href=&#34;https://myodfw.com/bonneville-hatchery-visitors-guide&#34; class=&#34;uri&#34;&gt;https://myodfw.com/bonneville-hatchery-visitors-guide&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Northwest Power and Conservation Council. (2015). Dams: Impacts on salmon and steelhead. &lt;a href=&#34;https://www.nwcouncil.org/reports/columbia-river-history/damsimpacts&#34; class=&#34;uri&#34;&gt;https://www.nwcouncil.org/reports/columbia-river-history/damsimpacts&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Statistics Anlysis with Pacific giant salamanders</title>
      <link>/project/chi/</link>
      <pubDate>Fri, 22 Nov 2019 15:05:12 -0800</pubDate>
      <guid>/project/chi/</guid>
      <description>
&lt;script src=&#34;/rmarkdown-libs/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;


&lt;div id=&#34;background&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Background&lt;/h3&gt;
&lt;p&gt;Around 1963, sections of forests near Mack Creek, Oregon were clear cut, meaning the trees were uniformly cut down (Gregory 2016). In 1993, Stanley V. Gregory and researchers at the Andrews Forest LTER Site began including Pacific giant salamanders (Dicamptodon tenebrosus) in their study called &lt;em&gt;Aquatic Vertebrate Population Study in Mack Creek, Andrews Experimental Forest, 1987 to present.&lt;/em&gt; The researchers recorded the weights of salamanders (g) and documented their locations within the area. The two forest sections of Mack Creek include clear cut sections as well as 500-year-old coniferous old growth forests (Gregory 2016). Within the two sections of forests, salamanders are found in Cascade, Pool and Side Channel. This report does not include salamanders found in Isolated Pool, as these areas are separated from the creek. Studying the Pacific giant salamander population in this area is relevant to understanding how new forests- the result of clear cutting- affect local wildlife populations, and how these effects compare to populations living in old growth forests.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;data-and-methods&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Data and Methods&lt;/h3&gt;
&lt;p&gt;The &lt;a href=&#34;https://portal.lternet.edu/nis/mapbrowse?packageid=knb-lter-and.4027.12&#34;&gt;data set&lt;/a&gt; used in this report was provided by the LTER Network Data Portal, and full metadata can be found &lt;a href=&#34;https://portal.lternet.edu/nis/metadataviewer?packageid=knb-lter-and.4027.12&#34;&gt;here&lt;/a&gt;. Sections of the forest are specified as clear cut (“CC”) and old growth (“OG”), while channel types are specified as Cascade, “C”, Pool, “P”, and Side Channel, “SC”. A Chi-squared (&lt;span class=&#34;math inline&#34;&gt;\(\chi\)&lt;/span&gt;&lt;sup&gt;2&lt;/sup&gt;) test was performed to determine if forest section was related to which channel type salamanders were found. Additionally, an unpaired two-sample t-test was used to find out if the weights of salamanders differed significantly between the two forest sections. Finally, a one-way ANOVA test was conducted to determine if there was a significant difference in mean salamander weight among the three channel types between the two forest sections. All analyses and figures were made using R Studio version 1.2.5001.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;mack_creek_map_3.png&#34; width=&#34;60%&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Figure. 1&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;Map of Oregon. The location of Mack Creek is designated by the red icon. Courtesy of &lt;a href=&#34;https://www.google.com/maps/place/44°13&amp;#39;17.3%22N+122°10&amp;#39;04.8%22W/@44.8758978,-124.1058318,7.57z/data=!4m5!3m4!1s0x0:0x0!8m2!3d44.2214667!4d-122.168!5m1!1e4?hl=en-US&#34;&gt;Google Maps&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;results&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Results&lt;/h3&gt;
&lt;div id=&#34;a.-annual-salamander-population-in-two-forest-sections-of-mack-creek.&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;A. Annual salamander population in two forest sections of Mack Creek.&lt;/h4&gt;
&lt;p&gt;Counts in clear cut forests tended to be less than counts in old growth forests until 2012.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/kai/index_files/figure-html/sections_line_graph-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Figure. 2&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;Annual counts of salamanders in Mack Creek from 1993 to 2017. Clear cut forests were shown as orange dotted line, the old growth forests were presented as blue line with triangles. Data: Andrews Forest LTER Site.&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;b.-salamander-abundance-by-channel-classification-and-forest-sections-in-2017.&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;B. Salamander abundance by channel classification and forest sections in 2017.&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Table. 1&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;Summary table of 2017 salamander population by channel classifications (Pool, Cascade and Side Channel) in old growth (OG) and clear cut (CC) sections of Mack Creek. Data: Andrews Forest LTER Site.&lt;/em&gt;&lt;/p&gt;
&lt;table class=&#34;table table-striped&#34; style=&#34;width: auto !important; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; &#34; colspan=&#34;4&#34;&gt;
&lt;div style=&#34;border-bottom: 1px solid #ddd; padding-bottom: 5px; &#34;&gt;
Salamander counts by channel and sections classification in 2017
&lt;/div&gt;
&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Section
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Cascade
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Pool
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Side Channel
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
Clear Cut
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
247 (55%)
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
31 (41%)
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
90 (55%)
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
Old Growth
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
201 (45%)
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
45 (59%)
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
74 (45%)
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The percentages show the proportions of salamanders in each channel type by section. For example, of the salamanders found in the cascade channel type, 55% were located in clear cut sections, while 45% were located in old growth sections.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;c.-association-between-channel-classifications-and-forest-sections-on-mean-salamander-weights.&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;C. Association between channel classifications and forest sections on mean salamander weights.&lt;/h4&gt;
&lt;p&gt;Is there a significant difference in where in the channel Pacific giant salamanders are located (pool, cascade or side channel) between the two sections (old growth and clear cut)?&lt;/p&gt;
&lt;p&gt;Looking into the Table.1, we could find that the percentages difference of two different sections within the same channel are relatively small, and all the percentages are close to 50%. It is possible that there is no connections between the sections and the channels to the weights of salamanders.&lt;/p&gt;
&lt;p&gt;We use Chi-Square (&lt;span class=&#34;math inline&#34;&gt;\(\chi\)&lt;/span&gt;&lt;sup&gt;2&lt;/sup&gt;) test to compare proportions and find their inner relationship.&lt;/p&gt;
&lt;p&gt;The Chi-Square (&lt;span class=&#34;math inline&#34;&gt;\(\chi\)&lt;/span&gt;&lt;sup&gt;2&lt;/sup&gt;) test results indicate that the proportions of salamanders in each section and channel type are to be expected if forest section is not a determining factor in where salamanders were located in Mack Creek. In other words, there was no significant difference in forest section (clear cut / old growth) based on which channel type salamanders were found (&lt;span class=&#34;math inline&#34;&gt;\(\chi\)&lt;/span&gt;&lt;sup&gt;2&lt;/sup&gt;(2) = 5.54, &lt;em&gt;p&lt;/em&gt; (0.063) &amp;gt; 0.05).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;d.-the-influence-of-forest-sections-on-pacific-giant-salamander-weights.&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;D. The influence of forest sections on Pacific giant salamander weights.&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/kai/index_files/figure-html/d_ttest_graph-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;
&lt;strong&gt;&lt;em&gt;Figure. 3&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;Counts of salamanders by weight for old growth and clear cut forest sections in 2017. The orange dotted line indicates mean salamander weight for clear cut sections, while the blue dotted line indicates mean salamander weight for old growth sections. The means appear relatively close together. Data: Andrews Forest LTER Site.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;In year 2017, mean weight of Pacific giant salamanders (g) measured in clear cut forests (7.78 &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 9.9, n = 368) was not significantly different from the average salamander weight in old growth forest areas (6.58 &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 8.96, n = 328) by a unpaired two-sample t-test (t(692.79) = 1.67, &lt;em&gt;p&lt;/em&gt;(0.096) &amp;gt; 0.05) . The difference in mean weight between the two groups is 1.20 g, with a negligible effect size (Cohen’s d = 0.13). Therefore, we consider the salamander weights in clear cut areas were not significantly different from old growth ones. Histogram was presented in Figure.3.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;e.-the-influence-of-channel-classifications-on-pacific-giant-salamanders-weights.&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;E. The influence of channel classifications on Pacific giant salamanders weights.&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;1. Visually compare Pacific giant salamander weights between the three channel classifications.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/kai/index_files/figure-html/e_channel_beeswarm-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Figure. 4&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;The weight distribution, mean, and standard deviation graph of Pacific giant salamanders in channels- Pool(blue), Side Channel(pink), Cascade(green) in year 2017. Different colored points represent distribution of the samples’ weights. The grey points show the mean weights within each channel group (Side channel - 5.68, Pool - 9.3, and Cascade - 7.52), the error bars indicate the standard deviation of the data (Side channel - 8.27, Pool - 13.62, and Cascade - 9.03). Data: Andrews Forest LTER Site.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. Is there a significant difference in mean weights for Pacific giant salamanders observed in Pool vs. Cascade vs. Side Channel in 2017?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Table. 2&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;The summary table for different channel classifications of mean weights in Pacific giant salamanders. Data: Andrews Forest LTER Site.&lt;/em&gt;&lt;/p&gt;
&lt;div align=&#34;center&#34;&gt;
&lt;table class=&#34;table table-striped&#34; style=&#34;width: auto !important; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; &#34; colspan=&#34;6&#34;&gt;
&lt;div style=&#34;border-bottom: 1px solid #ddd; padding-bottom: 5px; &#34;&gt;
Summary table of weights (g) in channels
&lt;/div&gt;
&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Channel
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Mean
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Standard Deviation
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Standard Error
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Variance
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Sample Size
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
Cascade
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
7.52
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
9.03
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.43
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
81.50
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
448
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
Pool
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
9.30
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
13.62
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
1.56
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
185.58
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
76
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
Side Channel
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
5.68
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
8.27
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.65
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
68.31
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
164
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;We adopted the one-way analysis of variance (ANOVA) to solve that problem.&lt;/p&gt;
&lt;p&gt;This method is suitable because the data satisfies all assumptions for ANOVA:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: lower-alpha&#34;&gt;
&lt;li&gt;&lt;p&gt;The sample distribution should be normal. Through the beeswarm plot we could observe that most weights were concentrated at 0-6g. The data was presented as skewed to the left side. However, the sample sizes within each groups (Pool - 76, Cascade - 448, and Side channel - 164) are all more than 30, which could be considered as large enough. So the distributions of the sample statistics (mean, median) will be normally distributed.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Samples are independent. Due to the different locations of these three channels, the sample data collected from different places should be independent.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Population variances are equal. In the summary table (Table. 2), notice that the largest variance (Pool - 185.58) is less than the four times of the smallest variance (Side Channel - 68.31), which means the variances are close enough. Besides, based on the results from Levene’s Test (Levene’s F(2) = 2.39, &lt;em&gt;p&lt;/em&gt; = 0.093 &amp;gt; 0.05), there is no significant difference in variances between groups.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In 2017, mean weight of Pacific giant salamanders (g) measured in Cascade area (7.52 &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 9.03, n = 448)，in Pool area (9.3 &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 13.62, n = 76), and in Side Channel area (5.68 &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 8.27, n = 164) have significant difference in at least two groups from the average salamander weight by a one-way ANOVA (F(2, 684) = 4.22, &lt;em&gt;p&lt;/em&gt;(0.015) &amp;lt; 0.05). Histogram presented in Figure.5.&lt;/p&gt;
&lt;p&gt;To further study which groups differ significantly with each other, we analyzed with Tukey’s test for Honestly Significant Differences (Tukey’s HSD).
The results showed that there is no significant difference between Pool and Cascade groups (&lt;em&gt;p adj&lt;/em&gt;(0.286) &amp;gt; 0.05), and between Side Channel and Cascade groups (&lt;em&gt;p adj&lt;/em&gt;(0.084) &amp;gt; 0.05), but the mean salamander weight differed significantly between Side Channel and Pool (&lt;em&gt;p adj&lt;/em&gt;(0.017) &amp;lt; 0.05). However, the difference in mean weight between the Side Channel and Pool groups is 3.62 g, with a small effect size (Cohen’s d = 0.35). Though the two groups show difference in data, it is highly possible that it happened because of accidental errors. Therefore, more research needs to be done to determine whether the two groups are actually different significantly.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. Limits about comparing means across the groups.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Mean is a measurement that is easily swayed by outliers, and it looks like the data has significant outliers. It may be more beneficial to also compare medians as well to make sure that outliers aren’t affecting the accuracy of our results. This could be done through rank-based tests.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;summary&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Summary&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Channel locations and sampling forest sections are independent (Table. 1).&lt;/li&gt;
&lt;li&gt;The mean weight of salamanders in old growth and clear cut sections of the forest were not significantly different in 2017 (Figure. 4).&lt;/li&gt;
&lt;li&gt;Within the three channels, the mean salamander weight differed significantly between Side Channel and Pool, but not with other groups (Figure. 5).&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;References&lt;/h3&gt;
&lt;p&gt;Gregory S. V. 2016. Aquatic Vertebrate Population Study in Mack Creek, Andrews Experimental Forest, 1987 to present. Environmental Data Initiative. &lt;a href=&#34;https://doi.org/10.6073/pasta/5de64af9c11579266ef20da2ff32f702&#34; class=&#34;uri&#34;&gt;https://doi.org/10.6073/pasta/5de64af9c11579266ef20da2ff32f702&lt;/a&gt;. Data set accessed 12/03/19.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Unpaired T-test with California Spiny Lobster</title>
      <link>/project/ttest/</link>
      <pubDate>Wed, 06 Nov 2019 15:05:12 -0800</pubDate>
      <guid>/project/ttest/</guid>
      <description>
&lt;script src=&#34;/rmarkdown-libs/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;


&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Attach packages
library(tidyverse)
library(janitor)
library(effsize)
library(kableExtra)

# Tidy up the data:
# 1. Tell R all the -99999 values are actually NAs. Then clean all the column names into snake_case.
lob_rdata &amp;lt;- readr::read_csv(&amp;quot;lobster_abundance_sbc_lter.csv&amp;quot;,
                             na = &amp;quot;-99999&amp;quot;) %&amp;gt;%
  clean_names()

# 2. Make the raw data into tidy format by uncounting the observations to separeted rows.
lob_tidy &amp;lt;- lob_rdata %&amp;gt;% 
  tidyr::uncount(count)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;introduction&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Introduction&lt;/h3&gt;
&lt;p&gt;To limit the impact of human activities on coral reef, Marine Protected Areas (MPA) were set up (Mora, et al. 2006). In this report, two areas are located in or near the California Fish and Game Network of Marine Protected Areas: Naples (NAPL) and Isla Vista (IVEE), where they both established as MPAs on 2012; three outside: Arroyo Quemado (AQUE), Mohawk (MOHK) and Carpinteria (CARP). The protections on reef also benefit to kelp forests (Claisse, et al. 2013). With little human interfere, MPAs help to research the effects of fishing on kelp forest community dynamics.
Spiny lobsters are part of the necessary food chains in kelp forests off southern California (Reed D. 2019). After six years of reservation, there was a 5–10% increase in the mean size of lobsters at some MPAs (Kay, et al. 2012).
Here, we use data collected by Santa Barbara Coastal Long-Term Ecological Research program to compare the population, size of lobsters in MPAs and non-MPAs from 2012 to 2018.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;data-and-methods&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Data and Methods&lt;/h3&gt;
&lt;p&gt;Data for California Spiny Lobster abundance and location from 2012 - 2018 were collected and provided by &lt;a href=&#34;https://sbclter.msi.ucsb.edu/&#34;&gt;Santa Barbara Coastal Long-Term Ecological Research&lt;/a&gt; program (SBC LTER). Samples are collected during the lobster fishing season (October to March) along the mainland coast of the Santa Barbara Channel. For more information on collection methods and spatial information, see &lt;a href=&#34;https://portal.edirepository.org/nis/mapbrowse?scope=knb-lter-sbc&amp;amp;identifier=77&amp;amp;revision=newest&#34;&gt;metadata&lt;/a&gt;. Lobster size distributions are faceted by site and year. Mean lobster size (mm) was compared for MPA and non-MPA areas in the same year, year 2012 and 2018 within each group by two-sample unpaired t-tests (α
= 0.05). All data analyses and figures are accomplished in R studio version 3.6.1.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;results&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Results&lt;/h3&gt;
&lt;div id=&#34;annual-lobster-abundance-by-site&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;1. Annual lobster abundance by site&lt;/h4&gt;
&lt;p&gt;From 2012 to 2018, the total amount of lobster has changed in different trends in five different areas (Figure.1).&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Count the lobster amount by site and year.
lob_year &amp;lt;- lob_tidy %&amp;gt;% 
  count(year, site)

# Made a colorblind-friendly palette.
cbPalette &amp;lt;- c(&amp;quot;#E69F00&amp;quot;, &amp;quot;#56B4E9&amp;quot;, &amp;quot;#009E73&amp;quot;, &amp;quot;#0072B2&amp;quot;, &amp;quot;#CC79A7&amp;quot;)

# Show the annual changes in line graph, which is grouped by site. Instead of legend, using labels to indicate different sites.
ggplot(data = lob_year, aes(x = year, y = n)) +
  geom_line(aes(color = site), 
            size = 1, 
            show.legend = FALSE) +
  geom_point(aes(color = site, shape = site), 
             size = 2.5, 
             show.legend = FALSE) +
  scale_shape_manual(values = c(15, 16,17, 18, 25)) + #change the point shape manually
  annotate(&amp;quot;text&amp;quot;, 
           x = 2018.5:2018.5:2018.5:2018.5:2018.5, 
           y = c(54, 343, 946, 164, 298), 
           label = c(&amp;quot;AQUE&amp;quot;, &amp;quot;CARP&amp;quot;, &amp;quot;IVEE&amp;quot;, &amp;quot;MOHK&amp;quot;, &amp;quot;NAPL&amp;quot;),
           color = cbPalette)+
  labs(x = &amp;quot;Year&amp;quot;, y = &amp;quot;Lobster population&amp;quot;)+
  scale_color_manual(values = cbPalette) +
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/ttest/index_files/figure-html/AnnualChange-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;
&lt;strong&gt;&lt;em&gt;Figure. 1&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;Lobster population changes from 2012 to 2018 in four different sites. IVEE means Isla Vista area, CARP = Carpinteria, NAPL = Naples, MOHK = Mohawk, AQUE = Arroyo Quemado, correspondingly. IVEE and NAPL belongs to MPA group, other three places are in non-MPA group. Data: SBC LTER.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;In Arroyo Quemado area, the population of lobster has barely not changed during the years. While in Isla Vista area, the total amount of lobster has increased significantly especially in year 2016-2018, in contrast to other areas. Lobster amount in Naples generally in the trend of rising. Carpinteria’s lobster population experienced a period of increasing but dropped down in 2018.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;lobster-size-distribution-by-time-and-site&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;2. Lobster size distribution by time and site&lt;/h4&gt;
&lt;p&gt;After the Marine Protected Areas set up in 2012, the lobster size distribution observed in 5 different areas has changed until 2018 (Figure.2).&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# To compare the data only in year 2012 and 2018, use filter() and select() to simplified the new dataframe.
lob_compare_site &amp;lt;- lob_tidy %&amp;gt;% 
  filter(year %in% c(2012, 2018)) %&amp;gt;% 
  select(year, site, size_mm)

# Creat facets labels in advance.
site_labs &amp;lt;- c(&amp;quot;Arroyo Quemado&amp;quot;, &amp;quot;Carpinteria&amp;quot;, &amp;quot;Isla Vista&amp;quot;, &amp;quot;Mohawk&amp;quot;, &amp;quot;Naples&amp;quot;)
names(site_labs) &amp;lt;- c(&amp;quot;AQUE&amp;quot;,&amp;quot;CARP&amp;quot;,&amp;quot;IVEE&amp;quot;,&amp;quot;MOHK&amp;quot;, &amp;quot;NAPL&amp;quot;)

# Create 10 histograms to show the distribution of lobster sizes and organize facets by site and time.
ggplot(data = lob_compare_site, aes(x = size_mm)) +
  geom_histogram(aes(fill = site), show.legend = FALSE) +
  labs(x = &amp;quot;Spiny lobster size (mm)&amp;quot;, y = &amp;quot;Number of lobster in each size group&amp;quot;)+
  facet_grid(year~site, scales = &amp;quot;free&amp;quot;,
             labeller = labeller(site = site_labs))+
  scale_fill_manual(values = cbPalette) +
  theme_minimal() &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/ttest/index_files/figure-html/2year5siteHisto-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Figure. 2&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;Distribution of lobster size (mm) in 2012 and 2018 in five different sites. The height of bars in the figure shows the number of lobster in the size scale. The higher the bar is, the more number of lobster sizes are in that scale. The total bar area represent the total population of lobster. Data: SBC LTER.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Through vertical comparison, we can notice that in Isla Vista and Naples, the total amount of lobster has increased from 2012 to 2018; while the other three sites showed decrease in population. These site groups with different trends coincided with MPA and non-MPA group, meaning that Marine Protected Areas might have positive correlation to the population of lobster in that area.&lt;/p&gt;
&lt;p&gt;Comparing horizontally, in year 2012, Carpinteria and Mohawk had relatively high population of lobster; while in year 2018, Isla Vista had the hugest amount of lobster.&lt;/p&gt;
&lt;p&gt;Most lobster size concentrated in 60 - 100 mm. Mohawk used to have more bigger-size lobsters than other areas (80-120 mm). However, in 2018, little amount of big-size lobsters appeared in Mohawk. On the contrary, Isla Vista and Naples gradually have more big lobster in 2018.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;mean-lobster-sizes-at-mpa-versus-non-mpa-sites-in-2012-and-2018.&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;3. Mean lobster sizes at MPA versus non-MPA sites in 2012 and 2018.&lt;/h4&gt;
&lt;p&gt;To explore the possible influence of MPA policy to the lobsters size, we divided the five areas into two groups: MPA and non-MPA group, at two time point: year 2012 and 2018. We will use two-tailed, unpaired t-test to exam: is there a significant difference in lobster size mean between MPA and non-MPA groups; is there a significant difference at year 2012 and 2018 within each group.&lt;/p&gt;
&lt;p&gt;Table.1 showed the summary table for lobsters in two time points and two groups. From 2012 to 2018, mean size in MPA group increased, but decreased in non-MPA group. In 2012, lobsters in MPA areas were smaller in mean than those in non-MPA group. But in 2018, MPA lobsters’ size mean exceeds non-MPA mean.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Get the corresponding category for different sites
lob_tdata &amp;lt;- lob_compare_site %&amp;gt;% 
  mutate(category = ifelse(site %in% c(&amp;quot;NAPL&amp;quot;, &amp;quot;IVEE&amp;quot;), &amp;quot;MPA&amp;quot;, &amp;quot;non-MPA&amp;quot;)) %&amp;gt;% 
  mutate(year = as.character(year)) # For the t-test later, let R know &amp;quot;year&amp;quot; is &amp;quot;factors&amp;quot; here not just &amp;quot;numbers&amp;quot;.

# Calculate the mean, median, standaed deviation and sample sizes for lobsters from the MPA group and non-MPA group.
lob_tsummary &amp;lt;- lob_tdata %&amp;gt;%
  group_by(category, year) %&amp;gt;%
  summarize(
    mean = mean(size_mm, na.rm = TRUE),
    median = median(size_mm, na.rm = TRUE),
    sd = sd(size_mm, na.rm = TRUE),
    n = n()
  )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Table. 1&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;Summary table of descriptive statistics for lobster size (mm) in year 2012 and 2018 separately in MPA and non-MPA site groups. Data: SBC LTER.&lt;/em&gt;&lt;/p&gt;
&lt;div align=&#34;center&#34;&gt;

&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Make the summary table for descriptive statistics:
lob_tsummary %&amp;gt;% 
  kable(col.names = c(&amp;quot;Category&amp;quot;, &amp;quot;Year&amp;quot;, &amp;quot;Mean&amp;quot;, &amp;quot;Median&amp;quot;, &amp;quot;Standard Deviation&amp;quot;, &amp;quot;Sample Size&amp;quot;),
        align = &amp;quot;cccccc&amp;quot;,
        digits = 2
        ) %&amp;gt;% 
  kable_styling(bootstrap_options = &amp;quot;striped&amp;quot;, 
                full_width = F,
                position = &amp;quot;center&amp;quot;,
                row_label_position = c
                )%&amp;gt;% 
  add_header_above(c(&amp;quot;Lobster Size Summary Table&amp;quot; = 6))&lt;/code&gt;&lt;/pre&gt;
&lt;table class=&#34;table table-striped&#34; style=&#34;width: auto !important; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; &#34; colspan=&#34;6&#34;&gt;
&lt;div style=&#34;border-bottom: 1px solid #ddd; padding-bottom: 5px; &#34;&gt;
Lobster Size Summary Table
&lt;/div&gt;
&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Category
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Year
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Mean
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Median
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Standard Deviation
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Sample Size
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
MPA
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
2012
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
67.38
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
64.5
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
12.15
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
32
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
MPA
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
77.57
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
78.0
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
11.70
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
1244
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
non-MPA
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
2012
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
74.92
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
75.0
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
12.41
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
199
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
non-MPA
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
2018
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
73.62
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
73.0
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
10.09
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
561
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Filter data only in year 2012.
lob_2012 &amp;lt;- lob_tdata %&amp;gt;% 
  filter(year == 2012)

# Made two sided unpaired t-test for MPA and non-MPA sites and calculate conhen&amp;#39;s d.
y2012_ttest &amp;lt;- t.test(data = lob_2012, size_mm~category)
y2012_d &amp;lt;- effsize::cohen.d(data = lob_2012, size_mm~category, na.rm = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;In year 2012, mean size of lobsters (mm) measured in MPA sites’ samples (67.38 &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 12.15, n = 32) differed significantly from lobster size in non-MPA areas (74.92 &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 12.41, n = 199) by a unpaired two-sample t-test (t(42.09) = -3.25, &lt;em&gt;p&lt;/em&gt;(0.002) &amp;lt; 0.05). The difference in mean size between the two groups is 10.54 mm, with a medium effect size (Cohen’s d = -0.61). Therefore, we consider the MPA lobster sizes were significantly different than non-MPA ones. Density presented in Figure.3(a).&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Filter data only in year 2018.
lob_2018 &amp;lt;- lob_tdata %&amp;gt;% 
  filter(year == 2018)

# Made two sided unpaired t-test for MPA and non-MPA sites and calculate conhen&amp;#39;s d.
y2018_ttest &amp;lt;- t.test(data = lob_2018, size_mm~category)
y2018_d &amp;lt;- effsize::cohen.d(size_mm~category,data = lob_2018,na.rm = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;In year 2018, mean size of lobster (mm) measured in MPA sites’ samples (77.57 &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 11.7, n = 1244) differed significantly from lobster size in non MPA sites (73.62 &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 10.09, n = 561) by a unpaired two-sample t-test (t(1239.51) = 7.31, &lt;em&gt;p&lt;/em&gt;&amp;lt; 0.001). The difference in mean size between the two groups is 3.95 mm, with a small effect size (Cohen’s d = 0.35). Though the two groups show difference in data, it is highly possible that the difference was due to accidental error. Therefore, more researches need to be done to make sure the two groups are actually different significantly. Presented in Figure.3(a).&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Create Kernel density plots to compare lobster size in MPA group and non-MPA group separetly in year 2012 and 2018.

ggplot(data = lob_tdata, aes(x = size_mm, color = category, fill = category)) +
  geom_density(alpha = .3,show.legend = FALSE)+
  facet_wrap(~year)+
  geom_vline(data = lob_tsummary, aes(xintercept = mean,
                                 colour = category),
             linetype = &amp;quot;dashed&amp;quot;,
             size = 1,
             show.legend = FALSE) +
  scale_fill_manual(values = c(&amp;quot;#56B4E9&amp;quot;, &amp;quot;#CC79A7&amp;quot;))+
  scale_color_manual(values = c(&amp;quot;#56B4E9&amp;quot;, &amp;quot;#CC79A7&amp;quot;))+
  scale_y_discrete(expand = c(0,0)) +
  labs(x = &amp;quot;Lobster size (mm)&amp;quot;, y = &amp;quot;Kernel density&amp;quot;)+
  annotate(&amp;quot;text&amp;quot;, x = 60, y = .045, label = &amp;quot;MPA&amp;quot;, color = &amp;quot;#56B4E9&amp;quot;) +
  annotate(&amp;quot;text&amp;quot;, x = 95, y = .045, label = &amp;quot;non-MPA&amp;quot;, color = &amp;quot;#CC79A7&amp;quot;) +
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/ttest/index_files/figure-html/facet28-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Figure. 3(a)&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;Lobster distribution in MPA and non-MPA groups at year 2012 and 2018. The blue color represents MPAs, purple represents non-MPAs. Data: SBC LTER.&lt;/em&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;lob_mpa &amp;lt;- lob_tdata %&amp;gt;% 
  filter(category == &amp;quot;MPA&amp;quot;) 

mpa_ttest &amp;lt;- t.test(data = lob_mpa, size_mm~year)
mpa_d &amp;lt;- effsize::cohen.d(size_mm~year, data = lob_mpa, na.rm = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;For MPA samples, mean size of lobster (mm) measured in year 2012 (67.38 &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 12.15, n = 32) differed significantly from lobster size in year 2018 (77.57 &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 11.7, n = 1244) by a unpaired two-sample t-test (t(32.5) = -4.69, &lt;em&gt;p&lt;/em&gt;&amp;lt; 0.001). The difference in mean size between the two groups is 10.19 mm, with a large effect size (Cohen’s d = -0.87). Therefore, the lobster sizes increased significantly from 2012 to 2018. See Figure.3(b).&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;lob_nonmpa &amp;lt;- lob_tdata %&amp;gt;% 
  filter(category == &amp;quot;non-MPA&amp;quot;) 

nonmpa_ttest &amp;lt;- t.test(data = lob_nonmpa, size_mm~year)
nonmpa_d &amp;lt;- effsize::cohen.d(size_mm~year, data = lob_nonmpa)&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;4&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;For non-MPA samples, mean size of lobster (mm) measured in year 2012 (74.92 &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 12.41, n = 199) is not different significantly from lobster size in year 2018 (73.62 &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 10.09, n = 561) by a unpaired two-sample t-test (t(296.01) = 1.33, &lt;em&gt;p&lt;/em&gt; = 0.18). The difference in mean size between the two groups is 1.30 mm, with a negligible effect size (Cohen’s d = 0.12). Therefore, the lobster sizes in non-MPA areas have no significant change between 2012 and 2018. See Figure.3(b).&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Create Kernel density plots to compare lobster size in year 2012 and 2018 within the groups of MPA and non-MPA.

ggplot(data = lob_tdata, aes(x = size_mm, fill = year, color = year)) +
  geom_density(alpha = .3,show.legend = FALSE)+
  facet_wrap(~category)+
  geom_vline(data = lob_tsummary, aes(xintercept = mean,
                                 colour = year),
             linetype = &amp;quot;dashed&amp;quot;,
             size = 1,
             show.legend = FALSE) +
  scale_y_discrete(expand = c(0,0)) +
  scale_fill_manual(values = c(&amp;quot;#E69F00&amp;quot;, &amp;quot;#009E73&amp;quot;)) +
  scale_color_manual(values = c(&amp;quot;#E69F00&amp;quot;, &amp;quot;#009E73&amp;quot;)) +
  labs(x = &amp;quot;Lobster size (mm)&amp;quot;, y = &amp;quot;Kernel density&amp;quot;)+
  annotate(&amp;quot;text&amp;quot;, x = 88, y = .045, label = &amp;quot;2018&amp;quot;, color = &amp;quot;#009E73&amp;quot;) +
  annotate(&amp;quot;text&amp;quot;, x = 55, y = .045, label = &amp;quot;2012&amp;quot;, color = &amp;quot;#E69F00&amp;quot;) +
  theme_minimal()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/en/project/ttest/index_files/figure-html/facetmpa-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;
&lt;strong&gt;&lt;em&gt;Figure. 3(b)&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;Lobster distribution within MPA and non-MPA groups at year 2012 and 2018. The orange color represents year 2012, green represents 2018. Data: SBC LTER.&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;summary&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Summary&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;From 2012 to 2018, lobster populations in MPA areas increased in general (Figure.1).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;From 2012 to 2018, more large-size lobsters appears in MPA areas while non-MPA declines in amount of big size ones (Figure.2).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;In year 2012, MPA and non-MPA group had significant difference in size with a medium effect size; in year 2018, the significant difference may not be accurate because of the small effect size (Figure.3(a)).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Within the MPA groups, the lobster sizes increased significantly from 2012 to 2018; in non-MPA groups, no significant difference showed between 2012 and 2018 (Figure.3(b)).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;References&lt;/h3&gt;
&lt;p&gt;Claisse, Jeremy T., et al. “Kelp forest habitat restoration has the potential to increase sea urchin gonad biomass.” Ecosphere 4.3 (2013): 1-19.&lt;/p&gt;
&lt;p&gt;Kay, Matthew C., et al. “Collaborative assessment of California spiny lobster population and fishery responses to a marine reserve network.” Ecological applications 22.1 (2012): 322-335.&lt;/p&gt;
&lt;p&gt;Mora, Camilo, et al. “Coral reefs and the global network of marine protected areas.” (2006): 1750-1751.&lt;/p&gt;
&lt;p&gt;Daniel, Reed C. 2019. “SBC LTER: Reef: Abundance, size and fishing effort for California Spiny Lobster (Panulirus interruptus) , ongoing since 2012.” Environmental Data Initiative. &lt;a href=&#34;https://doi.org/10.6073/pasta/a593a675d644fdefb736750b291579a0&#34; class=&#34;uri&#34;&gt;https://doi.org/10.6073/pasta/a593a675d644fdefb736750b291579a0&lt;/a&gt;. Dataset accessed 10/30/2019.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Green Footprint</title>
      <link>/project/green-footprint/</link>
      <pubDate>Wed, 27 Apr 2016 00:00:00 +0000</pubDate>
      <guid>/project/green-footprint/</guid>
      <description></description>
    </item>
    
  </channel>
</rss>
